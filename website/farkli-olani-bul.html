<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Farklƒ± Olanƒ± Bul - Telimen Eƒüitim</title>

    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        fredoka: ['Fredoka', 'cursive'],
                    }
                }
            }
        }
    </script>

    <style>
        * {
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        /* Akƒ±llƒ± Tahta Zoom Kilidi */
        html,
        body,
        button {
            touch-action: manipulation;
            -ms-touch-action: manipulation;
        }

        body {
            font-family: 'Fredoka', cursive;
            overflow-x: hidden;
        }

        @keyframes pulse-critical {

            0%,
            100% {
                transform: scaleX(1);
            }

            50% {
                transform: scaleX(1.02);
            }
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-8px);
            }

            75% {
                transform: translateX(8px);
            }
        }

        @keyframes float-up {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateY(-60px) scale(1.3);
            }
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0.7;
            }
        }

        @keyframes damage-flash {

            0%,
            100% {
                background-color: transparent;
            }

            50% {
                background-color: rgba(239, 68, 68, 0.3);
            }
        }

        @keyframes highlight-pulse {

            0%,
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.8);
            }

            50% {
                transform: scale(1.1);
                box-shadow: 0 0 0 8px rgba(16, 185, 129, 0.4);
            }
        }

        .pulse-critical {
            animation: pulse-critical 0.5s ease-in-out infinite;
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        .damage-flash {
            animation: damage-flash 0.4s ease-in-out;
        }

        .floating-text {
            animation: float-up 1s ease-out forwards;
        }

        .confetti {
            animation: confetti-fall 3s linear forwards;
        }

        .highlight-correct {
            animation: highlight-pulse 0.5s ease-in-out infinite;
            border: 4px solid #10b981 !important;
            z-index: 100;
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-emerald-100 via-teal-100 to-cyan-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;
        const { motion, AnimatePresence } = Motion;

        // ============================================
        // V3.0: AUDIO SYSTEM USING AUDIOCONTEXT API
        // ============================================
        const createAudioContext = () => {
            return new (window.AudioContext || window.webkitAudioContext)();
        };

        // Sound generator class
        class SoundGenerator {
            constructor() {
                this.ctx = null;
                this.enabled = true;
            }

            init() {
                if (!this.ctx) {
                    this.ctx = createAudioContext();
                }
            }

            // Correct answer: High frequency "Ding" sound
            playCorrect() {
                if (!this.enabled) return;
                this.init();

                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();

                osc.connect(gain);
                gain.connect(this.ctx.destination);

                osc.frequency.setValueAtTime(880, this.ctx.currentTime); // A5
                osc.frequency.setValueAtTime(1100, this.ctx.currentTime + 0.1); // C#6
                osc.type = 'sine';

                gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
                gain.gain.exponentialDecayTo = 0.01;
                gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);

                osc.start(this.ctx.currentTime);
                osc.stop(this.ctx.currentTime + 0.3);
            }

            // Wrong answer: Low frequency "Buzz" sound
            playWrong() {
                if (!this.enabled) return;
                this.init();

                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();

                osc.connect(gain);
                gain.connect(this.ctx.destination);

                osc.frequency.setValueAtTime(150, this.ctx.currentTime);
                osc.frequency.setValueAtTime(100, this.ctx.currentTime + 0.15);
                osc.type = 'sawtooth';

                gain.gain.setValueAtTime(0.2, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.25);

                osc.start(this.ctx.currentTime);
                osc.stop(this.ctx.currentTime + 0.25);
            }

            // All Same correct: Victory fanfare
            playVictory() {
                if (!this.enabled) return;
                this.init();

                const notes = [523.25, 659.25, 783.99, 1046.50]; // C5, E5, G5, C6
                const duration = 0.15;

                notes.forEach((freq, i) => {
                    const osc = this.ctx.createOscillator();
                    const gain = this.ctx.createGain();

                    osc.connect(gain);
                    gain.connect(this.ctx.destination);

                    osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
                    osc.type = 'sine';

                    const startTime = this.ctx.currentTime + (i * duration);
                    gain.gain.setValueAtTime(0, startTime);
                    gain.gain.linearRampToValueAtTime(0.25, startTime + 0.02);
                    gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);

                    osc.start(startTime);
                    osc.stop(startTime + duration);
                });
            }

            // Game Over: Descending melody
            playGameOver() {
                if (!this.enabled) return;
                this.init();

                const notes = [392, 349.23, 329.63, 261.63]; // G4, F4, E4, C4
                const duration = 0.25;

                notes.forEach((freq, i) => {
                    const osc = this.ctx.createOscillator();
                    const gain = this.ctx.createGain();

                    osc.connect(gain);
                    gain.connect(this.ctx.destination);

                    osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
                    osc.type = 'triangle';

                    const startTime = this.ctx.currentTime + (i * duration);
                    gain.gain.setValueAtTime(0.2, startTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration - 0.02);

                    osc.start(startTime);
                    osc.stop(startTime + duration);
                });
            }

            toggle() {
                this.enabled = !this.enabled;
                return this.enabled;
            }
        }

        // Global sound generator instance
        const soundGen = new SoundGenerator();

        // ============================================
        // EMOJI SETS
        // ============================================
        const EASY_EMOJIS = ['üê∂', 'üê±', 'üê∞', 'ü¶ä', 'üêª', 'üêº', 'üê®', 'ü¶Å', 'üêØ', 'üêÆ'];
        const MEDIUM_EMOJIS = ['üçé', 'üçä', 'üçã', 'üçá', 'üçì', 'ü•ï', 'üåΩ', 'ü•¶', 'üçï', 'üçî'];
        const HARD_EMOJIS = ['‚≠ê', 'üíé', 'üî•', 'üíß', 'üåô', '‚òÄÔ∏è', '‚ùÑÔ∏è', 'üå∏', 'üçÄ', 'üåà'];

        // Alternative emojis for "completely different icon" variation
        const DIFFERENT_EMOJIS = {
            'üê∂': 'üê±', 'üê±': 'üê∞', 'üê∞': 'ü¶ä', 'ü¶ä': 'üêª', 'üêª': 'üêº',
            'üêº': 'üê®', 'üê®': 'ü¶Å', 'ü¶Å': 'üêØ', 'üêØ': 'üêÆ', 'üêÆ': 'üê∂',
            'üçé': 'üçä', 'üçä': 'üçã', 'üçã': 'üçá', 'üçá': 'üçì', 'üçì': 'ü•ï',
            'ü•ï': 'üåΩ', 'üåΩ': 'ü•¶', 'ü•¶': 'üçï', 'üçï': 'üçî', 'üçî': 'üçé',
            '‚≠ê': 'üíé', 'üíé': 'üî•', 'üî•': 'üíß', 'üíß': 'üåô', 'üåô': '‚òÄÔ∏è',
            '‚òÄÔ∏è': '‚ùÑÔ∏è', '‚ùÑÔ∏è': 'üå∏', 'üå∏': 'üçÄ', 'üçÄ': 'üåà', 'üåà': '‚≠ê'
        };

        // Game configuration
        const INITIAL_TIME = 60;
        const CORRECT_BONUS = 3;
        const WRONG_PENALTY = 5;
        const ALL_SAME_BONUS = 10;
        const ALL_SAME_CHANCE = 0.2;
        const SHOW_ANSWER_DURATION = 1500;

        // ============================================
        // COMPONENTS
        // ============================================

        // Sound toggle button
        const SoundToggle = ({ enabled, onToggle }) => {
            return (
                <motion.button
                    whileHover={{ scale: 1.1 }}
                    whileTap={{ scale: 0.9 }}
                    onClick={onToggle}
                    className={`fixed top-4 right-4 z-50 w-12 h-12 rounded-full shadow-lg
                        flex items-center justify-center text-2xl
                        ${enabled
                            ? 'bg-emerald-500 text-white'
                            : 'bg-gray-300 text-gray-500'}`}
                    title={enabled ? 'Sesi Kapat' : 'Sesi A√ß'}
                >
                    {enabled ? 'üîä' : 'üîá'}
                </motion.button>
            );
        };

        // Floating text component
        const FloatingText = ({ text, color, x, y, onComplete }) => {
            useEffect(() => {
                const timer = setTimeout(onComplete, 1000);
                return () => clearTimeout(timer);
            }, [onComplete]);

            return (
                <div
                    className="floating-text fixed pointer-events-none font-fredoka font-bold text-2xl z-50"
                    style={{
                        left: x,
                        top: y,
                        color: color,
                        textShadow: '2px 2px 4px rgba(0,0,0,0.3)'
                    }}
                >
                    {text}
                </div>
            );
        };

        // Confetti component
        const Confetti = ({ onComplete }) => {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f7dc6f', '#bb8fce', '#58d68d'];
            const confettiPieces = Array.from({ length: 50 }, (_, i) => ({
                id: i,
                left: Math.random() * 100,
                delay: Math.random() * 0.5,
                color: colors[Math.floor(Math.random() * colors.length)],
                size: Math.random() * 10 + 5
            }));

            useEffect(() => {
                const timer = setTimeout(onComplete, 3000);
                return () => clearTimeout(timer);
            }, [onComplete]);

            return (
                <div className="fixed inset-0 pointer-events-none z-50 overflow-hidden">
                    {confettiPieces.map(piece => (
                        <div
                            key={piece.id}
                            className="confetti absolute"
                            style={{
                                left: `${piece.left}%`,
                                top: '-20px',
                                width: piece.size,
                                height: piece.size,
                                backgroundColor: piece.color,
                                borderRadius: Math.random() > 0.5 ? '50%' : '0',
                                animationDelay: `${piece.delay}s`
                            }}
                        />
                    ))}
                </div>
            );
        };

        // Card component - V3.0: Clear visible variations only (NO DISTORTION)
        const Card = ({ emoji, isDifferent, variationType, onClick, index, gridSize, isHighlighted, disabled }) => {
            // V3.0: Only use clearly visible variations - NO SCALE/DISTORTION
            const getCardStyle = () => {
                if (!isDifferent) return {};

                switch (variationType) {
                    case 'opacity':
                        // A) Opacity - clearly faded (0.6)
                        return { opacity: 0.6 };
                    case 'rotate':
                        // B) Rotation - 15 degrees
                        return { transform: 'rotate(15deg)' };
                    case 'rotateNeg':
                        // B) Rotation - negative 15 degrees
                        return { transform: 'rotate(-15deg)' };
                    case 'hue':
                        // C) Hue Rotate - 45 degrees for clear color difference
                        return { filter: 'hue-rotate(45deg)' };
                    default:
                        return {};
                }
            };

            const cardSize = gridSize === 2 ? 'w-28 h-28' : gridSize === 3 ? 'w-24 h-24' : 'w-20 h-20';
            const fontSize = gridSize === 2 ? 'text-6xl' : gridSize === 3 ? 'text-5xl' : 'text-4xl';

            return (
                <motion.button
                    initial={{ scale: 0, rotate: -10 }}
                    animate={{ scale: 1, rotate: 0 }}
                    exit={{ scale: 0, rotate: 10 }}
                    transition={{
                        type: "spring",
                        stiffness: 400,
                        damping: 20,
                        delay: index * 0.03
                    }}
                    whileHover={!disabled ? { scale: 1.08, y: -4 } : {}}
                    whileTap={!disabled ? { scale: 0.95 } : {}}
                    onClick={!disabled ? onClick : undefined}
                    className={`${cardSize} bg-white rounded-2xl shadow-lg 
                        flex items-center justify-center 
                        border-4 transition-all duration-200
                        ${isHighlighted
                            ? 'highlight-correct border-emerald-500'
                            : 'border-white hover:border-emerald-300 hover:shadow-xl cursor-pointer'}
                        ${disabled && !isHighlighted ? 'opacity-60 cursor-not-allowed' : ''}`}
                >
                    <span className={`${fontSize}`} style={getCardStyle()}>
                        {emoji}
                    </span>
                </motion.button>
            );
        };

        // Progress bar component
        const ProgressBar = ({ timeLeft, maxTime }) => {
            const percentage = (timeLeft / maxTime) * 100;
            const isCritical = timeLeft <= 10;

            return (
                <div className="w-full max-w-lg mx-auto mb-6">
                    <div className="h-4 bg-white/50 rounded-full overflow-hidden shadow-inner backdrop-blur-sm">
                        <motion.div
                            className={`h-full rounded-full ${isCritical ? 'pulse-critical' : ''}`}
                            style={{
                                width: `${percentage}%`,
                                background: isCritical
                                    ? 'linear-gradient(90deg, #ef4444, #f87171)'
                                    : 'linear-gradient(90deg, #10b981, #34d399)'
                            }}
                            animate={{
                                boxShadow: isCritical
                                    ? ['0 0 20px rgba(239,68,68,0.5)', '0 0 30px rgba(239,68,68,0.8)', '0 0 20px rgba(239,68,68,0.5)']
                                    : '0 0 10px rgba(16,185,129,0.3)'
                            }}
                            transition={{
                                boxShadow: { duration: 0.5, repeat: Infinity }
                            }}
                        />
                    </div>
                </div>
            );
        };

        // ============================================
        // MAIN GAME COMPONENT
        // ============================================
        const Game = () => {
            const [gameState, setGameState] = useState('menu');
            const [score, setScore] = useState(0);
            const [level, setLevel] = useState(1);
            const [timeLeft, setTimeLeft] = useState(INITIAL_TIME);
            const [cards, setCards] = useState([]);
            const [isAllSame, setIsAllSame] = useState(false);
            const [differentIndex, setDifferentIndex] = useState(-1);
            const [floatingTexts, setFloatingTexts] = useState([]);
            const [showConfetti, setShowConfetti] = useState(false);
            const [damageFlash, setDamageFlash] = useState(false);
            const [shakeGrid, setShakeGrid] = useState(false);
            const [highlightedCardIndex, setHighlightedCardIndex] = useState(-1);
            const [soundEnabled, setSoundEnabled] = useState(true);
            const [highScore, setHighScore] = useState(() => {
                return parseInt(localStorage.getItem('farkliOlaniBulHighScore') || '0');
            });

            const gridRef = useRef(null);

            // Sound toggle handler
            const handleSoundToggle = useCallback(() => {
                const newState = soundGen.toggle();
                setSoundEnabled(newState);
            }, []);

            // Get grid size based on level
            const getGridSize = useCallback(() => {
                if (level <= 3) return 2;
                if (level <= 6) return 3;
                return 4;
            }, [level]);

            // Get emoji set based on level
            const getEmojiSet = useCallback(() => {
                if (level <= 3) return EASY_EMOJIS;
                if (level <= 6) return MEDIUM_EMOJIS;
                return HARD_EMOJIS;
            }, [level]);

            // V3.0: Variation types - ONLY clear visible differences (NO DISTORTION!)
            const getVariationType = useCallback(() => {
                if (level <= 3) {
                    // Easy: completely different emoji
                    return 'different';
                } else {
                    // Medium & Hard: Clear visual variations (NO SCALE!)
                    const types = ['opacity', 'rotate', 'rotateNeg', 'hue'];
                    return types[Math.floor(Math.random() * types.length)];
                }
            }, [level]);

            // Generate new round
            const generateRound = useCallback(() => {
                const gridSize = getGridSize();
                const totalCards = gridSize * gridSize;
                const emojiSet = getEmojiSet();
                const baseEmoji = emojiSet[Math.floor(Math.random() * emojiSet.length)];

                const allSame = Math.random() < ALL_SAME_CHANCE;
                setIsAllSame(allSame);

                let diffIndex = -1;
                let variationType = null;
                let differentEmoji = baseEmoji;

                if (!allSame) {
                    diffIndex = Math.floor(Math.random() * totalCards);
                    variationType = getVariationType();

                    if (variationType === 'different') {
                        differentEmoji = DIFFERENT_EMOJIS[baseEmoji] || emojiSet[(emojiSet.indexOf(baseEmoji) + 1) % emojiSet.length];
                    }
                }

                setDifferentIndex(diffIndex);
                setHighlightedCardIndex(-1);

                const newCards = Array.from({ length: totalCards }, (_, i) => ({
                    id: i,
                    emoji: i === diffIndex && variationType === 'different' ? differentEmoji : baseEmoji,
                    isDifferent: i === diffIndex,
                    variationType: i === diffIndex ? variationType : null
                }));

                setCards(newCards);
            }, [getGridSize, getEmojiSet, getVariationType]);

            // Add floating text
            const addFloatingText = useCallback((text, color, x, y) => {
                const id = Date.now();
                setFloatingTexts(prev => [...prev, { id, text, color, x, y }]);
            }, []);

            // Remove floating text
            const removeFloatingText = useCallback((id) => {
                setFloatingTexts(prev => prev.filter(ft => ft.id !== id));
            }, []);

            // Show correct answer
            const showCorrectAnswer = useCallback(() => {
                if (differentIndex >= 0) {
                    setHighlightedCardIndex(differentIndex);
                    setGameState('showing-answer');

                    setTimeout(() => {
                        setHighlightedCardIndex(-1);
                        setGameState('playing');
                        generateRound();
                    }, SHOW_ANSWER_DURATION);
                } else {
                    generateRound();
                }
            }, [differentIndex, generateRound]);

            // Handle card click
            const handleCardClick = useCallback((card, event) => {
                if (gameState !== 'playing') return;

                const rect = event.currentTarget.getBoundingClientRect();
                const x = rect.left + rect.width / 2 - 30;
                const y = rect.top;

                if (card.isDifferent) {
                    // Correct!
                    soundGen.playCorrect();
                    setScore(prev => prev + 10);
                    setTimeLeft(prev => Math.min(prev + CORRECT_BONUS, INITIAL_TIME + 30));
                    setLevel(prev => prev + 1);
                    addFloatingText(`+${CORRECT_BONUS} sn`, '#10b981', x, y);
                    generateRound();
                } else {
                    // Wrong!
                    soundGen.playWrong();
                    setTimeLeft(prev => Math.max(prev - WRONG_PENALTY, 0));
                    addFloatingText(`-${WRONG_PENALTY} sn`, '#ef4444', x, y);
                    setDamageFlash(true);
                    setShakeGrid(true);
                    setTimeout(() => {
                        setDamageFlash(false);
                        setShakeGrid(false);
                        showCorrectAnswer();
                    }, 400);
                }
            }, [gameState, generateRound, addFloatingText, showCorrectAnswer]);

            // Handle "All Same" button click
            const handleAllSameClick = useCallback((event) => {
                if (gameState !== 'playing') return;

                const rect = event.currentTarget.getBoundingClientRect();
                const x = rect.left + rect.width / 2 - 40;
                const y = rect.top;

                if (isAllSame) {
                    // Correct!
                    soundGen.playVictory();
                    setScore(prev => prev + 25);
                    setTimeLeft(prev => Math.min(prev + ALL_SAME_BONUS, INITIAL_TIME + 30));
                    setLevel(prev => prev + 1);
                    addFloatingText(`+${ALL_SAME_BONUS} sn üéâ`, '#8b5cf6', x, y);
                    setShowConfetti(true);
                    setTimeout(() => generateRound(), 500);
                } else {
                    // Wrong!
                    soundGen.playWrong();
                    setTimeLeft(prev => Math.max(prev - WRONG_PENALTY, 0));
                    addFloatingText(`-${WRONG_PENALTY} sn`, '#ef4444', x, y);
                    setDamageFlash(true);
                    setShakeGrid(true);
                    setTimeout(() => {
                        setDamageFlash(false);
                        setShakeGrid(false);
                        showCorrectAnswer();
                    }, 400);
                }
            }, [gameState, isAllSame, generateRound, addFloatingText, showCorrectAnswer]);

            // Start game
            const startGame = useCallback(() => {
                soundGen.init(); // Initialize audio context on user interaction
                setGameState('playing');
                setScore(0);
                setLevel(1);
                setTimeLeft(INITIAL_TIME);
                generateRound();
            }, [generateRound]);

            // Timer
            useEffect(() => {
                if (gameState !== 'playing') return;

                const timer = setInterval(() => {
                    setTimeLeft(prev => {
                        if (prev <= 1) {
                            soundGen.playGameOver();
                            setGameState('gameover');
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);

                return () => clearInterval(timer);
            }, [gameState]);

            // Update high score
            useEffect(() => {
                if (gameState === 'gameover' && score > highScore) {
                    setHighScore(score);
                    localStorage.setItem('farkliOlaniBulHighScore', score.toString());
                }
            }, [gameState, score, highScore]);

            const gridSize = getGridSize();

            // Menu Screen
            if (gameState === 'menu') {
                return (
                    <div className="min-h-screen flex flex-col items-center justify-center p-4">
                        <SoundToggle enabled={soundEnabled} onToggle={handleSoundToggle} />

                        <motion.div
                            initial={{ opacity: 0, y: 30 }}
                            animate={{ opacity: 1, y: 0 }}
                            className="text-center"
                        >
                            <h1 className="text-5xl md:text-6xl font-bold text-emerald-700 mb-4 font-fredoka">
                                Farklƒ± Olanƒ± Bul
                            </h1>
                            <p className="text-xl text-emerald-600 mb-8 font-fredoka">
                                Dikkatli ol, farklƒ± olanƒ± hemen bul!
                            </p>

                            <div className="bg-white/70 backdrop-blur-md rounded-3xl p-6 mb-8 shadow-xl max-w-md mx-auto">
                                <div className="flex justify-around text-center">
                                    <div>
                                        <p className="text-gray-500 text-sm">En Y√ºksek Skor</p>
                                        <p className="text-3xl font-bold text-emerald-600">üèÜ {highScore}</p>
                                    </div>
                                </div>
                            </div>

                            <motion.button
                                whileHover={{ scale: 1.05 }}
                                whileTap={{ scale: 0.95 }}
                                onClick={startGame}
                                className="bg-gradient-to-r from-emerald-500 to-teal-500 text-white 
                                    font-bold text-2xl py-4 px-12 rounded-full shadow-lg
                                    hover:shadow-xl transition-all font-fredoka"
                            >
                                üéÆ Oyuna Ba≈üla
                            </motion.button>

                            <motion.a
                                href="index.html"
                                whileHover={{ scale: 1.05 }}
                                className="block mt-6 text-emerald-600 hover:text-emerald-700 
                                    font-medium text-lg font-fredoka"
                            >
                                üè† Ana Sayfa
                            </motion.a>
                        </motion.div>
                    </div>
                );
            }

            // Game Over Screen
            if (gameState === 'gameover') {
                const isNewHighScore = score >= highScore && score > 0;

                return (
                    <div className="min-h-screen flex flex-col items-center justify-center p-4">
                        <SoundToggle enabled={soundEnabled} onToggle={handleSoundToggle} />

                        <motion.div
                            initial={{ opacity: 0, scale: 0.8 }}
                            animate={{ opacity: 1, scale: 1 }}
                            className="text-center bg-white/80 backdrop-blur-md rounded-3xl p-8 shadow-2xl max-w-md"
                        >
                            <h2 className="text-4xl font-bold text-gray-700 mb-2 font-fredoka">
                                ‚è∞ S√ºre Doldu!
                            </h2>

                            {isNewHighScore && (
                                <motion.p
                                    initial={{ scale: 0 }}
                                    animate={{ scale: 1 }}
                                    className="text-2xl text-amber-500 font-bold mb-4"
                                >
                                    üéâ Yeni Rekor! üéâ
                                </motion.p>
                            )}

                            <div className="my-6 space-y-3">
                                <div className="bg-emerald-100 rounded-2xl p-4">
                                    <p className="text-gray-500 text-sm">Skorun</p>
                                    <p className="text-4xl font-bold text-emerald-600">üèÜ {score}</p>
                                </div>
                                <div className="bg-teal-100 rounded-2xl p-4">
                                    <p className="text-gray-500 text-sm">Ula≈üƒ±lan Seviye</p>
                                    <p className="text-3xl font-bold text-teal-600">üìä Level {level}</p>
                                </div>
                            </div>

                            <div className="flex flex-col gap-3">
                                <motion.button
                                    whileHover={{ scale: 1.05 }}
                                    whileTap={{ scale: 0.95 }}
                                    onClick={startGame}
                                    className="bg-gradient-to-r from-emerald-500 to-teal-500 text-white 
                                        font-bold text-xl py-3 px-8 rounded-full shadow-lg font-fredoka"
                                >
                                    üîÑ Tekrar Oyna
                                </motion.button>

                                <motion.a
                                    href="index.html"
                                    whileHover={{ scale: 1.05 }}
                                    className="text-emerald-600 hover:text-emerald-700 
                                        font-medium text-lg font-fredoka"
                                >
                                    üè† Ana Sayfa
                                </motion.a>
                            </div>
                        </motion.div>
                    </div>
                );
            }

            // Playing Screen
            const isShowingAnswer = gameState === 'showing-answer';

            return (
                <div className={`min-h-screen flex flex-col items-center p-4 pt-6 ${damageFlash ? 'damage-flash' : ''}`}>
                    <SoundToggle enabled={soundEnabled} onToggle={handleSoundToggle} />

                    {/* Floating Texts */}
                    {floatingTexts.map(ft => (
                        <FloatingText
                            key={ft.id}
                            text={ft.text}
                            color={ft.color}
                            x={ft.x}
                            y={ft.y}
                            onComplete={() => removeFloatingText(ft.id)}
                        />
                    ))}

                    {/* Confetti */}
                    {showConfetti && (
                        <Confetti onComplete={() => setShowConfetti(false)} />
                    )}

                    {/* Header */}
                    <div className="w-full max-w-lg mb-4">
                        <div className="flex justify-between items-center bg-white/70 backdrop-blur-md 
                            rounded-2xl px-6 py-3 shadow-lg">
                            <div className="text-center">
                                <p className="text-xs text-gray-500">SKOR</p>
                                <p className="text-2xl font-bold text-emerald-600">üèÜ {score}</p>
                            </div>
                            <div className="text-center">
                                <p className="text-xs text-gray-500">SEVƒ∞YE</p>
                                <p className="text-2xl font-bold text-teal-600">üìä {level}</p>
                            </div>
                            <div className="text-center">
                                <p className="text-xs text-gray-500">S√úRE</p>
                                <p className={`text-2xl font-bold ${timeLeft <= 10 ? 'text-red-500' : 'text-blue-600'}`}>
                                    ‚è±Ô∏è {timeLeft}
                                </p>
                            </div>
                        </div>
                    </div>

                    {/* Progress Bar */}
                    <ProgressBar timeLeft={timeLeft} maxTime={INITIAL_TIME} />

                    {/* Instruction */}
                    <motion.h2
                        key={`${level}-${isShowingAnswer}`}
                        initial={{ opacity: 0, y: -10 }}
                        animate={{ opacity: 1, y: 0 }}
                        className={`text-2xl font-bold mb-4 font-fredoka ${isShowingAnswer ? 'text-amber-600' : 'text-emerald-700'
                            }`}
                    >
                        {isShowingAnswer ? 'üëÄ ƒ∞≈üte Farklƒ± Olan!' : 'üîç Farklƒ± Olanƒ± Bul!'}
                    </motion.h2>

                    {/* Grid */}
                    <motion.div
                        ref={gridRef}
                        className={`grid gap-3 p-4 bg-white/50 backdrop-blur-md rounded-3xl shadow-xl 
                            ${shakeGrid ? 'shake' : ''}`}
                        style={{
                            gridTemplateColumns: `repeat(${gridSize}, 1fr)`
                        }}
                    >
                        <AnimatePresence mode="popLayout">
                            {cards.map((card, index) => (
                                <Card
                                    key={`${level}-${card.id}`}
                                    {...card}
                                    index={index}
                                    gridSize={gridSize}
                                    isHighlighted={highlightedCardIndex === index}
                                    disabled={isShowingAnswer}
                                    onClick={(e) => handleCardClick(card, e)}
                                />
                            ))}
                        </AnimatePresence>
                    </motion.div>

                    {/* "All Same" Button - Vibrant orange gradient */}
                    <div className="mt-8 pt-4 border-t-2 border-white/30 w-full max-w-md">
                        <motion.button
                            whileHover={!isShowingAnswer ? { scale: 1.05 } : {}}
                            whileTap={!isShowingAnswer ? { scale: 0.95 } : {}}
                            onClick={handleAllSameClick}
                            disabled={isShowingAnswer}
                            className={`w-full bg-gradient-to-r from-orange-500 via-amber-500 to-yellow-500 
                                text-white font-bold text-xl md:text-2xl py-4 px-8 rounded-full shadow-lg
                                transition-all font-fredoka
                                ${isShowingAnswer
                                    ? 'opacity-50 cursor-not-allowed'
                                    : 'hover:shadow-xl hover:from-orange-600 hover:via-amber-600 hover:to-yellow-600'}`}
                        >
                            ü§∑‚Äç‚ôÇÔ∏è HEPSƒ∞ AYNI!
                        </motion.button>
                    </div>

                    {/* Home Link */}
                    <a
                        href="index.html"
                        className="mt-4 text-emerald-600 hover:text-emerald-700 font-medium font-fredoka"
                    >
                        üè† Ana Sayfa
                    </a>
                </div>
            );
        };

        // Render App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Game />);
    </script>
</body>

</html>